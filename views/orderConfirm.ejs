<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Order Confirmation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/css/app.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f4f4f4;
    }
    .summary-card {
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
      padding: 20px;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <%- include('partials/navbar', { active: 'orders' }) %>
    <!-- rest of your order confirmation page -->
  <div class="container mt-4">
    <% if (error && error.length) { %>
      <div class="alert alert-danger"><%= error[0] %></div>
    <% } %>
    <% if (success && success.length) { %>
      <div class="alert alert-success"><%= success[0] %></div>
    <% } %>

    <h2>Order Confirmation</h2>
    <p class="text-muted">
      Please review your order details below. Once you confirm, your order will be processed.
    </p>

    <div class="summary-card mt-3">
      <!-- Order Info -->
      <h5>Order Information</h5>
      <div class="row mb-3">
        <div class="col-md-6">
          <p><strong>Order Number:</strong> <%= order.id %></p>
          <p><strong>Reference ID:</strong> <%= order.referenceId %></p>
          <p><strong>Status:</strong> <%= order.status %></p>
        </div>
        <div class="col-md-6">
          <p><strong>Order Date:</strong> <%= order.createOn %></p>
          <p><strong>Payment Method:</strong> <%= order.paymentMode %></p>
          <p><strong>Currency:</strong> <%= order.currency %></p>
        </div>
      </div>

      <hr>

      <!-- Purchased items -->
      <h5>Purchased Items</h5>
      <% if (!order.items || !order.items.length) { %>
        <p>No items found for this order.</p>
      <% } else { %>
        <div class="table-responsive">
          <table class="table table-striped align-middle">
            <thead>
              <tr>
                <th>Product</th>
                <th class="text-center">Qty</th>
                <th class="text-end">Unit Price</th>
                <th class="text-end">Subtotal</th>
              </tr>
            </thead>
            <tbody>
              <% for (let i = 0; i < order.items.length; i++) { %>
                <tr>
                  <td><%= order.items[i].product_name %></td>
                  <td class="text-center"><%= order.items[i].quantity %></td>
                  <td class="text-end">$<%= parseFloat(order.items[i].unit_price).toFixed(2) %></td>
                  <td class="text-end">$<%= parseFloat(order.items[i].subtotal).toFixed(2) %></td>
                </tr>
              <% } %>
            </tbody>
          </table>
        </div>
      <% } %>

      <hr>

      <!-- Billing summary -->
      <h5>Billing Summary</h5>
      <div class="row">
        <div class="col-md-6">
          <p><strong>Subtotal:</strong> $<%= parseFloat(order.subtotal).toFixed(2) %></p>
          <p><strong>Tax:</strong> $<%= parseFloat(order.tax).toFixed(2) %></p>
        </div>
        <div class="col-md-6">
          <p><strong>Shipping Fee:</strong> $<%= parseFloat(order.shipping_fee).toFixed(2) %></p>
          <p><strong>Discount:</strong> -$<%= parseFloat(order.discount).toFixed(2) %></p>
          <p class="fw-bold"><strong>Total Amount:</strong> $<%= parseFloat(order.total).toFixed(2) %></p>
        </div>
      </div>

      <hr>

      <!-- Shipping details -->
      <h5>Shipping Details</h5>
      <div class="row">
        <div class="col-md-6">
          <p><strong>Shipping Address:</strong><br>
            <%= order.customer.username %><br>
            <%= order.customer.address %><br>
            Contact: <%= order.customer.contact %>
          </p>
        </div>
        <div class="col-md-6">
          <p><strong>Shipping Method:</strong> Standard Delivery</p>
          <p><strong>Estimated Delivery:</strong> 3â€“5 business days</p>
        </div>
      </div>

      <hr>

      <!-- Contact information -->
      <h5>Need Help?</h5>
      <p class="mb-1">
        If you have any questions about your order, please contact our customer service:
      </p>
      <ul>
        <li>Email: support@supermarketapp.com</li>
        <li>Phone: +65 6123 4567</li>
      </ul>

      <hr>

      <!-- Confirm button only (cancel/edit removed) -->
      <div class="d-flex justify-content-end">
        <form action="/orders/confirm/<%= order.id %>" method="POST">
          <button type="submit" class="btn btn-primary">
            Confirm Order
          </button>
        </form>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
